<div id="wrapper">
  <div id="sidebar">
    <div id="widget">
      <script>
          function initMap() {
              <% if @arrRestaurants.length > 0 %>
                // The location of Uluru
                var uluru = {lat: <%= @arrRestaurants[0].latitude %>, lng: <%= @arrRestaurants[0].longitude %>};
                // The map, centered at Uluru
                var map = new google.maps.Map(
                    document.getElementById('widget'), {zoom: 15, center: uluru});

              <% else %>
                // The location of Uluru
                var uluru = {lat: 48.866667, lng: 2.333333};
                // The map, centered at Uluru
                var map = new google.maps.Map(
                    document.getElementById('widget'), {zoom: 4, center: uluru});

              <% end %>

              <% @arrRestaurants.each do |restaurant| %>
              // The marker, positioned at Uluru
              var marker = new google.maps.Marker({position: {lat: <%= restaurant.latitude %>, lng: <%= restaurant.longitude %>}, map: map, title: "<%= restaurant.listing_name %>"});
              <% end %>
          }
      </script>

      <script>
        $(document).ready(function(){
            $("#sidebar").stick_in_parent({offset_top: 20})
        });
      </script>

      <script async defer
              src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAhUhbx7WCVnx7MMPbfS_uwbqYD-8iFplI&callback=initMap">
      </script>
    </div>
  </div>
  <div id="article">
    <div class="row">
      <div class="col-md-12">
        <%= search_form_for @search, url: search_path do |f| %>
            <div class="row">
              <div class="col-md-6">
                <%= text_field_tag :search, params[:search], placeholder: "Ville ?", class:"form-control" %>
              </div>
              <div class="col-md-6">
                <%= f.select :restaurant_type_eq, [["Français","Français"],["Asiatique","Asiatique"],["Libanais","Libanais"],["Italien","Italien"],["Japonais","Japonais"],["Chinois","Chinois"],["Russe","Russe"],["Marocain","Marocain"],["Oriental","Oriental"],["Mexicain","Mexicain"],["Thaïlandais","Thaïlandais"],["Portugais","Portugais"],["Indien","Indien"],
                                                                        ["Turc","Turc"]], class:"form-control" %>
              </div>
            </div>

            <div class="row">
              <%= f.submit "Rechercher", class:"btn btn-primary" %>
            </div>
        <% end %>

        <hr>


        <div class="row">
          <% if @arrRestaurants.empty? %>
              Aucuns restaurants actuellement enregistré
          <% else %>
              <% @arrRestaurants.each do |restaurant| %>
                  <div class="col-md-4">
                    <div class="panel panel-default">
                      <div class="panel-heading preview">
                        <%= image_tag restaurant.photos[0].image.url(:medium) if restaurant.photos.length > 0 %>
                      </div>
                      <div class="panel-body">
                        <%= link_to restaurant.listing_name, restaurant_path(restaurant) %>
                      </div>
                    </div>
                  </div>
              <% end %>
              <% end %>
            </div>

      </div>
    </div>
  </div>
</div>